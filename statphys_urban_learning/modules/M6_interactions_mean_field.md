# M6 相互作用与平均场（外部性）

> **核心目标**：告别“理想气体”。真实世界是有趣的，因为粒子之间有**相互作用（Interactions）**。本章带你从独立的个体重返复杂的集体，你将遇到统计物理中最艰难也最迷人的挑战——多体问题，并学习对付它的第一个武器：**平均场（Mean Field）**。

## 推荐学习顺序
1. 通读本文，直观理解为什么相互作用会导致“相变”和“对称性破缺”。
2. 对照 Swendsen Chapter 16，看懂 Ising 模型的哈密顿量定义。
3. 跑通 `exercises/notebooks/E06_ising_mcmc.ipynb`，亲眼看看磁畴是如何形成的。

---

## Introduction（涌现的开端）

理想气体与“独立个体”在 M3/M4 里让你学会了势函数与配分函数的肌肉记忆，但它们也会立刻暴露一个现实矛盾：真实世界里个体之间并不独立。拥堵、同伴效应、网络外部性会把局部选择耦合成整体结构；一旦出现相互作用，能量函数与概率分布不再因子分解，配分函数 \(Z\) 也不再是单体 \(Z_1\) 的乘积（见：[[相互作用系统 Interacting systems]]）。这意味着“会写公式”不等于“会算系统”，多体问题的计算复杂度会指数级上升。

统计物理的概念飞跃是用最小模型把机制暴露出来。Ising 模型把“趋同/排斥”写成相互作用能量，用一个序参量去描述宏观有序（见：[[序参量 Order parameter]]），再用采样（MCMC）去观察它如何随噪声/温度变化。平均场近似则给出第一把可控的近似工具：用“有效场”把多体耦合压缩成自洽方程，让你直接看到相变/阈值如何从数学上冒出来。与此同时也必须提前标注边界：平均场系统性地忽略关联与大尺度涨落，往往在临界附近失效——这正是 M7 要面对的危机。

城市镜像同样直观：把外部性写进“能量/势”意味着你的预测会出现多稳态、路径依赖与阈值效应；而把复杂相互作用近似成平均场，对应的是“代表性环境/平均拥堵水平”的一阶近似。它在远离临界点时往往够用，但在临界附近会系统性低估涨落与相关——因此任何“平均场式政策评估”都必须伴随误差与适用范围的说明。

## References（Seminal papers，SSOT）
- **Weiss 1907**: Mean field theory. (`SP-M6-Weiss1907`)
- **Ising 1925**: The Ising model. (`SP-M6-Ising1925`)

---

## Part 1：多体问题的诅咒——因子分解失效

在理想气体或独立硬币模型中，概率分布可以写成：
\[ P(s_1, s_2, \dots, s_N) = P(s_1) P(s_2) \dots P(s_N) \]
这意味着我们可以单独研究每一个粒子。

一旦引入相互作用（哪怕只是和最近的邻居）：
\[ E = -J \sum_{\langle i,j \rangle} s_i s_j \]
某个状态 \(s_i\) 的概率不再只取决于它自己，还取决于它的邻居 \(s_j\)，而 \(s_j\) 又取决于 \(s_k\)... 全网牵一发而动全身。配分函数 \(Z\) 变成了一个无法拆解的 \(2^N\) 项求和。这就是多体难题。

> 👉 **深入理解**：
> - [[相互作用系统 Interacting systems]]：因子分解为何失效。

---

## Part 2：Ising 模型——复杂系统的果蝇

为了研究相互作用，物理学家发明了 **Ising 模型**：
- 每个格子 \(i\) 有一个自旋 \(s_i = \pm 1\)（物理上是磁矩，社科里是红蓝阵营/投票意向）。
- 能量 \(E = -J \sum s_i s_j\)。若 \(J>0\)，邻居同向能量低（铁磁/从众）；若 \(J<0\)，邻居反向能量低（反铁磁/竞争）。

尽管模型极其简单，它却能涌现出惊人的复杂性：在低温下，全网会自发打破对称性，统一朝上或朝下（**自发磁化/共识形成**）。

> 👉 **核心概念**：
> - [[序参量 Order parameter]]：如何描述集体的宏观有序度？

---

## Part 3：平均场近似——假装大家都是常数

虽然 Ising 模型很难精确解（一维除外），但我们可以用 **Weiss 平均场 (Mean Field)** 思想来近似：
假设对我（自旋 \(s_i\)）来说，周围邻居的具体涨落不重要，重要的是它们产生的一个**平均效应**。
\[ E_i \approx -s_i (J \cdot \langle s \rangle + h_{ext}) \]
于是多体问题瞬间退化回了单体问题：我在一个“有效场” \(H_{eff} = J\langle m \rangle + h\) 中做独立选择。

但这会引出一个**自洽方程（Self-consistency equation）**：我的选择 \(\langle s \rangle\) 取决于场，而场又取决于大家的平均选择 \(\langle m \rangle\)。即：
\[ m = \tanh(\beta J z m) \]
解这个方程，你会惊奇地发现：当温度 \(T < T_c\) 时，方程会出现非零解 \(m \neq 0\)。**相变**被数学预测出来了！

> 👉 **核心推导**：
> - [[Ising 平均场自洽方程]]：从 tanh 到分叉图。

---

## Part 4：城市映射——外部性与谢林模型

Ising 模型是所有社会相互作用模型的祖师爷。
- **Schelling 隔离模型**：其实就是一种动态的 Ising 模型（想和相似邻居在一起）。
- **交通拥堵**：我的路权成本取决于有多少别人在路上（负相互作用）。
- **产业集聚**：硅谷效应（正相互作用）。

这类问题的共同特征是：**个体的效用函数里包含了他人的状态**。这就是经济学说的**外部性（Externality）**。

| 统计物理 | 城市映射 |
| :--- | :--- |
| **相互作用 $J$** | 同伴效应 / 外部性强度 |
| **温度 $T$** | 个人特立独行的程度 / 噪音 |
| **磁化 $m$** | 社区隔离度 / 市场垄断度 / 舆论极化度 |

> 👉 [[城市外部性 拥堵同伴效应 与相互作用项]]

---

## Part 5：动手时刻 (Checklist)

### 必读
- [ ] **Reading Guide**: [[Swendsen_Ch16_Ising]] (Chapter 16: 16.1-16.3)
  > 点击查看 Ising Hamilton 和平均场近似公式。
- [ ] **Seminal Paper**: Weiss 1907 (Mean field 思想)。

### 习题
- [ ] **Written**: `exercises/written/M6_mean_field.md`
  - 画出 \(m = \tanh(\beta m)\) 的图像，找到它产生非零解的临界温度 \(T_c\)。
- [ ] **Notebook**: `exercises/notebooks/E06_ising_mcmc.ipynb`
  - 跑通 2D Ising 模拟，观察在 \(T_c \approx 2.269\) 附近，磁畴变得多大？（为 M7 临界现象做铺垫）

### 验收标准
- [ ] 知道为什么有相互作用时 \(Z\) 不能拆分。
- [ ] 能解释“平均场”错在哪里（忽略了近邻涨落）。
- [ ] 看到“自洽方程”能联想到多稳态。
