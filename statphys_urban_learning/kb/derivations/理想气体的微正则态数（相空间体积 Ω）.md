---
type: derivation
title: 理想气体的微正则态数（相空间体积 Ω）
tags: ['microcanonical', 'ideal-gas', 'phase-space', 'thermodynamic-limit', 'M2']
prereq: ['微正则系综 Microcanonical ensemble', '多重度 multiplicity Ω', '熵 Entropy', 'T,P,μ 作为熵的偏导定义']
source: ['Swendsen 2012', 'standard statmech']
status: ready
---

## 目标
- 用一条不断档的链路把 “计数/相空间体积 \(\Omega\) \(\to\) 熵 \(S=k_B\ln\Omega\) \(\to\) 温度/压强（偏导）” 串起来。
- 解释常见符号与两种约定：体积型 \(\Omega\)（cumulative）vs 壳层型 \(\omega\)（density of states）。

---

## 0) 记号与两种约定（避免“为什么突然多一个幂次”）
微正则里“态数”常见两种写法（很多教材混用会导致跳跃）：

1) **体积型（cumulative）**
\[
\Omega(E,V,N)\equiv \Gamma(E)
=\frac{1}{N!\,h^{3N}}\int d^{3N}r\,d^{3N}p\;\Theta\!\bigl(E-H(\mathbf p,\mathbf r)\bigr),
\]
它统计的是“能量 \(\le E\)” 的相空间体积（除以 \(h^{3N}\) 使其无量纲，并除以 \(N!\) 去除不可分辨粒子的标签重复计数）。

2) **壳层型（态密度）**
\[
\omega(E)=\frac{d\Omega}{dE}
=\frac{1}{N!\,h^{3N}}\int d^{3N}r\,d^{3N}p\;\delta\!\bigl(E-H(\mathbf p,\mathbf r)\bigr).
\]

两者关系来自 \(\frac{d}{dE}\Theta(E-H)=\delta(E-H)\)。

> 重要提醒：对理想气体，
> \(\Omega(E)\propto E^{3N/2}\)，而 \(\omega(E)\propto E^{3N/2-1}\)。这“差 1 次幂”只会给 \(\ln\Omega\) 带来一个 \(O(\ln E)\) 的修正；在热力学极限下由偏导读出的 \(T,P\) 不受影响（见：[[热力学极限 Thermodynamic limit]]）。

符号一览（只解释本卡会用到的）：
- \(h\)：普朗克常数（把相空间体积换成“格子数/态数”的半经典归一化；用 \(h\) 或 \(2\pi\hbar\) 是约定差异）。
- \(H(\mathbf p,\mathbf r)\)：哈密顿量（这里指能量函数，不是焓）。
- \(\Theta\)：Heaviside 阶跃函数（“能量不超过 \(E\)” 的开关）。
- \(\delta\)：Dirac delta（只取“能量恰为 \(E\)” 的壳层）。
- \(d^{3N}r\equiv \prod_{i=1}^N d^3 r_i\)，\(d^{3N}p\equiv \prod_{i=1}^N d^3 p_i\)：\(6N\) 维相空间体积元。
- \(N!\)：不可分辨粒子的 Gibbs 修正（避免把“交换标签”误当成新微观态）。

---

## 1) 模型：3D 经典理想气体
考虑 \(N\) 个质量为 \(m\) 的单原子经典理想气体，容器体积 \(V\)，孤立体系总能量为 \(E\)。

理想气体无相互作用，哈密顿量只含动能：
\[
H(\mathbf p,\mathbf r)=\sum_{i=1}^{N}\frac{\mathbf p_i^2}{2m}.
\]
它不依赖 \(\mathbf r\)，这会让位置积分直接给出 \(V^N\)。

---

## 2) 体积型 \(\Omega(E,V,N)\) 的相空间积分
按体积型定义：
\[
\Omega(E,V,N)
=\frac{1}{N!\,h^{3N}}
\int_{V^N} d^{3N}r
\int_{\mathbb R^{3N}} d^{3N}p\;
\Theta\!\left(E-\sum_{i=1}^{N}\frac{\mathbf p_i^2}{2m}\right).
\]

### 2.1 位置积分：为什么是 \(V^N\)
因为 \(\Theta(\cdots)\) 只依赖动量，不含 \(\mathbf r\)，所以
\[
\int_{V^N} d^{3N}r = V^N.
\]
直觉：每个粒子都能在体积 \(V\) 内任取位置，\(N\) 个粒子给出乘积 \(V^N\)。

于是
\[
\Omega(E,V,N)
=\frac{V^N}{N!\,h^{3N}}
\int d^{3N}p\;
\Theta\!\left(E-\sum_{i=1}^{N}\frac{\mathbf p_i^2}{2m}\right).
\]

### 2.2 动量积分：变成 \(3N\) 维球体体积
把所有动量堆成一个 \(3N\) 维向量
\[
\mathbf P=(\mathbf p_1,\ldots,\mathbf p_N)\in\mathbb R^{3N},
\qquad
|\mathbf P|^2=\sum_{i=1}^{N}\mathbf p_i^2.
\]
能量约束等价于
\[
\sum_{i=1}^{N}\frac{\mathbf p_i^2}{2m}\le E
\quad\Longleftrightarrow\quad
|\mathbf P|\le \sqrt{2mE}.
\]
因此动量积分就是半径 \(R=\sqrt{2mE}\) 的 \(d=3N\) 维球体体积：
\[
\int d^{3N}p\;\Theta(\cdots)=\mathrm{Vol}_{3N}(R),
\qquad
\mathrm{Vol}_{d}(R)=\frac{\pi^{d/2}}{\Gamma\!\left(\frac{d}{2}+1\right)}R^d.
\]
代入 \(d=3N\) 得
\[
\int d^{3N}p\;\Theta(\cdots)
=\frac{\pi^{3N/2}}{\Gamma\!\left(\frac{3N}{2}+1\right)}(2mE)^{3N/2}.
\]

---

## 3) 合并：显式形式与标度
把位置与动量部分合并：
\[
\boxed{
\Omega(E,V,N)
=\frac{V^N}{N!\,h^{3N}}
\frac{\pi^{3N/2}}{\Gamma\!\left(\frac{3N}{2}+1\right)}(2mE)^{3N/2}
}
\]
也常写成
\[
\Omega(E,V,N)
=\frac{V^N}{N!\,h^{3N}}
\frac{(2\pi mE)^{3N/2}}{\Gamma\!\left(\frac{3N}{2}+1\right)}.
\]

因此立刻读出你最常用的标度：
\[
\boxed{\ \Omega(E,V,N)\propto V^N\,E^{3N/2}\ }.
\]

> 与“两盒分球”完全同构：离散模型里 \(\Omega(n)=\binom{N}{n}\) 是“配置数”；连续体系里微观态变成相空间点，因此“计数”变成相空间体积（再做 \(h^{3N}\)、\(N!\) 的归一化）。

---

## 4) 从 \(\Omega\) 得到 \(S(E,V,N)\)，再推出 \(T\) 与 \(P\)
微正则核心定义：
\[
S(E,V,N)=k_B\ln\Omega(E,V,N).
\]
把只依赖 \(N,m,h\) 的项收进常数，得到结构上最重要的部分：
\[
S(E,V,N)=k_B\Bigl[N\ln V+\frac{3N}{2}\ln E+\text{const}(N,m,h)\Bigr].
\]

### 4.1 温度：\(\;1/T=(\partial S/\partial E)_{V,N}\)
\[
\frac{1}{T}=\left(\frac{\partial S}{\partial E}\right)_{V,N}
=k_B\frac{3N}{2}\frac{1}{E}
\quad\Longrightarrow\quad
\boxed{\,E=\frac{3}{2}Nk_B T\, }.
\]

### 4.2 压强：\(\;P/T=(\partial S/\partial V)_{E,N}\)
由基本关系 \(dS=\frac{1}{T}dE+\frac{P}{T}dV-\frac{\mu}{T}dN\)，可得
\[
\frac{P}{T}=\left(\frac{\partial S}{\partial V}\right)_{E,N}
=k_B\frac{N}{V}
\quad\Longrightarrow\quad
\boxed{\,PV=Nk_B T\, }.
\]

---

## 5) 你应该记住的“结构句”
把“离散计数 \(\to\) 连续相空间体积”的那一跳记成一句话就够：

> 微正则里宏观量来自对 \(\ln\Omega\) 的偏导；离散系统用组合数数态，连续系统用相空间体积数态（再除以 \(h^{3N}\) 与 \(N!\) 纠正维度与不可分辨性）。
