---
type: derivation
title: 已知均值与方差的最大熵解（高斯）
tags: ['maxent', 'exponential-family', 'gaussian', 'partition-function', 'M1']
prereq: ['最大熵推出指数族分布（通用模板）', '协方差与二阶导（通用）']
source: ['Jaynes 1957', 'standard (information theory)']
status: ready
---

## 目标
- 把一条推导主线讲清楚：最大熵 + 线性期望约束 \(\Rightarrow\) 指数族 \(\Rightarrow\) “已知均值与方差”时得到高斯分布。
- 解释为什么归一化因子 \(Z\)（配分函数）是解乘子（对偶参数）的核心：约束方程就是 \(\ln Z\) 的导数方程。

## 假设/约束
- 支持集：\(x\in\mathbb{R}\)（整条实线）；如果支持集不同（如 \(x\ge 0\)、或有界区间），最大熵解会变（例如指数分布/均匀分布等）。
- 连续变量用**微分熵**：
  \[
  h[p]=-\int_{-\infty}^{\infty} p(x)\ln p(x)\,dx.
  \]
  备注：微分熵的数值依赖单位/测度；更严格的表述是“相对熵（相对某个先验测度）最大化”。但在常用的 Lebesgue 测度下，下面结论成立且可直接用作推导模板。
- 约束（“已知均值与方差”的等价写法）：
  \[
  \int p(x)\,dx=1,\qquad
  \int x\,p(x)\,dx=\bar{x},\qquad
  \int x^2\,p(x)\,dx=\bar{x}^2+\sigma^2.
  \]

## 推导步骤（骨架）
### 1) 拉格朗日乘子 + 变分 \(\Rightarrow\) 指数族
构造泛函：
\[
\mathcal{L}[p]
=- \int p\ln p\,dx
+\lambda_0\Big(\int p\,dx-1\Big)
+\lambda_1\Big(\int x\,p\,dx-\bar{x}\Big)
+\lambda_2\Big(\int x^2\,p\,dx-(\bar{x}^2+\sigma^2)\Big).
\]
对 \(p(x)\) 做变分并令 \(\delta\mathcal{L}/\delta p(x)=0\)：
\[
-(\ln p(x)+1)+\lambda_0+\lambda_1 x+\lambda_2 x^2=0
\]
所以
\[
p(x)=\exp(\lambda_0-1)\exp(\lambda_1 x+\lambda_2 x^2).
\]
为了让 \(p(x)\) 可归一化（积分有限），二次项系数必须使指数在 \(|x|\to\infty\) 时衰减：也就是 \(\lambda_2<0\)。因此常把符号改写成统计力学/指数族的“负号版本”（更易和 \(e^{-\beta E}\) 对齐）：
\[
p_{\theta}(x)=\frac{1}{Z(\theta)}\exp\!\big(-\theta_1 x-\theta_2 x^2\big),\qquad \theta_2>0.
\]
其中
\[
Z(\theta)=\int_{-\infty}^{\infty}\exp\!\big(-\theta_1 x-\theta_2 x^2\big)\,dx.
\]

### 2) 指数二次型配方 \(\Rightarrow\) 高斯形状
对指数里的二次式配方：
\[
\theta_2 x^2+\theta_1 x
=\theta_2\Big(x+\frac{\theta_1}{2\theta_2}\Big)^2-\frac{\theta_1^2}{4\theta_2}.
\]
于是
\[
p_{\theta}(x)\propto \exp\!\Big(-\theta_2\big(x-m\big)^2\Big),
\quad
m=-\frac{\theta_1}{2\theta_2}.
\]
这已经是高斯分布的形状；剩下的只是确定 \(\theta_1,\theta_2\) 与 \((\bar{x},\sigma^2)\) 的关系。

### 3) 为什么 \(Z\) 是“核心”：约束 \(\Leftrightarrow\) \(\ln Z\) 的导数方程
一般指数族写作：
\[
p_{\theta}(x)=\frac{1}{Z(\theta)}\exp\!\big(-\theta^\top f(x)\big),
\quad
Z(\theta)=\int \exp\!\big(-\theta^\top f(x)\big)\,dx.
\]
对 \(Z\) 求导（把导数移入积分）：
\[
\partial_{\theta_k}Z(\theta)
=\int -f_k(x)\exp\!\big(-\theta^\top f(x)\big)\,dx.
\]
两边除以 \(Z\)：
\[
\partial_{\theta_k}\ln Z(\theta)
=\frac{1}{Z}\partial_{\theta_k}Z
=-\int f_k(x)\,p_{\theta}(x)\,dx
=-\mathbb{E}_{\theta}[f_k].
\]
因此约束 \(\mathbb{E}_{\theta}[f_k]=c_k\) 等价于
\[
\boxed{-\partial_{\theta_k}\ln Z(\theta)=c_k.}
\]
这就是“\(Z\) 决定乘子”的精确含义：你解的是 \(\theta\)，而你真正写下来的方程是 \(\nabla_{\theta}\ln Z\) 的方程。

### 4) 在高斯例子里把 \(Z\) 算出来（看清楚“解乘子”的机制）
对
\[
Z(\theta_1,\theta_2)=\int_{-\infty}^{\infty}\exp(-\theta_2 x^2-\theta_1 x)\,dx
\]
配方并做高斯积分可得：
\[
Z(\theta_1,\theta_2)=\sqrt{\frac{\pi}{\theta_2}}\exp\!\Big(\frac{\theta_1^2}{4\theta_2}\Big).
\]
于是
\[
\ln Z=\frac{1}{2}\ln\pi-\frac{1}{2}\ln\theta_2+\frac{\theta_1^2}{4\theta_2}.
\]
用“导数生成期望”：
\[
-\partial_{\theta_1}\ln Z=-\frac{\theta_1}{2\theta_2}=\mathbb{E}[X]=\bar{x}
\Rightarrow
\theta_1=-\frac{\bar{x}}{\sigma^2},
\]
\[
-\partial_{\theta_2}\ln Z=\frac{1}{2\theta_2}+\frac{\theta_1^2}{4\theta_2^2}=\mathbb{E}[X^2]=\bar{x}^2+\sigma^2
\Rightarrow
\theta_2=\frac{1}{2\sigma^2}.
\]
因此最大熵解为：
\[
\boxed{
p^*(x)=\frac{1}{\sqrt{2\pi\sigma^2}}\exp\!\Big(-\frac{(x-\bar{x})^2}{2\sigma^2}\Big)
=\mathcal{N}(\bar{x},\sigma^2).
}
\]

## 结果（你应该记住）
- 最大熵 + 线性期望约束 \(\Rightarrow\) 指数族：\(p(x)\propto \exp(-\theta^\top f(x))\)。
- “已知均值 \(\bar{x}\) 与方差 \(\sigma^2\)” \(\Rightarrow\) \(f(x)=(x,x^2)\) \(\Rightarrow\) 高斯是唯一可归一化的最大熵解。
- \(Z(\theta)\) 不只是归一化常数；\(\ln Z\) 是对偶参数的生成函数：
  \[
  \mathbb{E}[f_k]=-\partial_{\theta_k}\ln Z,\qquad
  \mathrm{Cov}(f_k,f_\ell)=\partial_{\theta_k}\partial_{\theta_\ell}\ln Z.
  \]

## 检查
- 归一化：对高斯积分应得到 1。
- 可积性：\(\theta_2>0\) 必须成立，否则 \(Z\) 发散。
- 量纲：若 \(x\) 的单位是 \([x]\)，则 \(\theta_1\) 单位为 \(1/[x]\)，\(\theta_2\) 单位为 \(1/[x]^2\)。

## Source anchors
- Jaynes 1957（条目：`SP-M1-Jaynes1957-I`）：最大熵作为推断框架；线性约束 \(\Rightarrow\) 指数族的总开关。
- 本仓库相关卡片：[[最大熵推出指数族分布（通用模板）]]、[[协方差与二阶导（通用）]]。
