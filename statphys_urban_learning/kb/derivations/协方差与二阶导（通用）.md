---
type: derivation
title: 协方差与二阶导（通用）
tags: ['exponential-family', 'M5']
prereq: ['最大熵推出指数族分布（通用模板）']
source: ['standard exponential family identities']
status: ready
---

## 目标
- 对指数族 \(p(x)\propto e^{-\theta^\top f(x)}\)，证明：
  - 一阶导给均值
  - 二阶导给协方差

## 设定
- 定义：
\[
Z(\theta)=\sum_x \exp(-\theta^\top f(x)),\quad
p_\theta(x)=\frac{1}{Z(\theta)}\exp(-\theta^\top f(x)).
\]

## 一阶导（均值）
\[
\partial_{\theta_k}\ln Z
= \frac{1}{Z}\sum_x (-f_k(x))e^{-\theta^\top f(x)}
= -\sum_x f_k(x)p_\theta(x)
= -\mathbb{E}_\theta[f_k].
\]
所以：
\[
\boxed{\mathbb{E}_\theta[f_k] = -\partial_{\theta_k}\ln Z.}
\]

## 二阶导（协方差）
再求导：
\[
\partial_{\theta_\ell}\partial_{\theta_k}\ln Z
= -\partial_{\theta_\ell}\mathbb{E}_\theta[f_k]
= \mathbb{E}_\theta[f_k f_\ell]-\mathbb{E}_\theta[f_k]\mathbb{E}_\theta[f_\ell]
= \mathrm{Cov}_\theta(f_k,f_\ell).
\]
所以：
\[
\boxed{\partial_{\theta_k}\partial_{\theta_\ell}\ln Z = \mathrm{Cov}(f_k,f_\ell).}
\]

## 解释（涨落-响应）
- 协方差越大 ⇒ 系统对参数扰动越敏感（响应大）。
