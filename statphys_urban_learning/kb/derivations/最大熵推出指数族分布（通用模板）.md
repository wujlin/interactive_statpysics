---
type: derivation
title: 最大熵推出指数族分布（通用模板）
tags: ['maxent', 'exponential-family', 'M1']
prereq: ['Shannon 熵与最大熵原则']
source: ['Jaynes / Sethna']
status: ready
---

## 目标
- 在“归一化 + 若干线性期望约束”下最大化熵，得到指数族形式。

## 约束
- 归一化：\(\sum_x p(x)=1\)
- 线性期望约束：\(\sum_x p(x) f_k(x) = c_k,\ k=1,\dots,m\)

## 推导
1) 最大化 Shannon 熵：
\[
H(p)=-\sum_x p(x)\ln p(x)
\]
2) 构造拉格朗日函数：
\[
\mathcal{L}
= -\sum_x p(x)\ln p(x)
+ \lambda\Big(\sum_x p(x)-1\Big)
+ \sum_{k=1}^m \lambda_k\Big(\sum_x p(x)f_k(x)-c_k\Big).
\]
3) 对每个 \(x\) 做变分/求偏导令 0：
\[
\frac{\partial \mathcal{L}}{\partial p(x)}=-(\ln p(x)+1)+\lambda+\sum_k \lambda_k f_k(x)=0
\]
⇒
\[
\ln p(x) = \lambda-1 + \sum_k \lambda_k f_k(x).
\]
4) 指数化并吸收常数，得到：
\[
p(x)=\frac{1}{Z(\lambda)}\exp\!\Big(\sum_k \lambda_k f_k(x)\Big).
\]
常见写法是把符号换成负号：
\[
p(x)=\frac{1}{Z(\theta)}\exp\!\Big(-\theta^\top f(x)\Big).
\]

## 结果（你应该记住）
- 最大熵 + 线性约束 ⇒ 指数族
- 归一化常数：
\[
Z(\theta)=\sum_x \exp(-\theta^\top f(x)).
\]

## 检查
- 若只有归一化约束：得到均匀分布
- 若 \(f(x)=E(x)\)：得到 Boltzmann 分布
- 若 \(f(x)=(x,x^2)\)（已知均值与方差）：得到高斯分布（见：[[已知均值与方差的最大熵解（高斯）]]）
